#:kivy 2.3.0
#:import dp kivy.metrics.dp

<NotePad@Widget>:
    # Properties for the notepad
    is_playing: False
    is_in_scale: True
    is_pressed: False
    velocity: 100
    
    # Grid position
    pad_row: 0
    pad_col: 0
    
    # Color logic based on state (FIX INDENTATION)
    bg_color: (0.22, 0.84, 0.43, 1) if self.is_playing else (0.27, 0.27, 0.27, 1) if self.is_in_scale else (0.13, 0.13, 0.13, 1)
    
    canvas.before:
        Color:
            rgba: self.bg_color
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(8)]
        Color:
            rgba: 0.4, 0.4, 0.4, 1
        Line:
            rounded_rectangle: (*self.pos, *self.size, dp(8))
            width: 1

    Label:
        text: "C4" if not hasattr(root, 'note_text') else root.note_text
        pos: root.pos
        size: root.size
        font_size: dp(12)
        bold: True
        color: 1, 1, 1, 1
        halign: 'center'
        valign: 'middle'
        text_size: self.size
        
    # Touch handling implementation would go in the Python class
    # on_touch_down: self.handle_press() if self.collide_point(*args[1].pos) else None  
    # on_touch_up: self.handle_release() if self.collide_point(*args[1].pos) else None
